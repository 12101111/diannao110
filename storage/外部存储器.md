# 外部存储器

## 机械硬盘

硬盘（英语：Hard Disk Drive，简称HDD）是电脑上使用坚硬的旋转盘片为基础的非易失性存储设备，它在平整的磁性表面存储数据，离磁性表面很近有磁头，磁头上的电磁线圈可以记录盘片中的磁性信息并产生电流，电流被控制芯片处理以完成信息读取；信息可以通过相反的方式写入，即信息经过控制芯片处理后转换成电流，电流在磁头产生磁场，使盘片的磁性信息变化。硬盘可以以任意顺序读取硬盘中的数据（不同于磁带）。硬盘包括一至数片高速转动的碟片以及放在悬臂上的磁头，一般每一个碟片两面都有磁性表面，两面都有磁头，盘片由微型电机带动。

早期的硬盘其中的碟片可以更换，不过现代硬盘将碟片与磁头固定在金属盒中，金属盒外有控制电路。硬盘碟片转速极快，与碟片的距离极小，因此要求碟片需要十分平整洁净。硬盘内部是无尘状态，金属机身内部几乎完全密闭，仅有一个带有过滤材料的气孔用于平衡因工作产生的热量而导致的气压差（高级硬盘内部充有氦气，没有气孔，这会降低能耗，减小发热，提高容量和转速）。硬盘的组装在无尘环境中，普通环境下打开硬盘会使灰尘落在碟片上导致硬盘损坏，所以千万不可取下硬盘上的螺丝。为了避免磁头碰撞碟片，厂商设计出各种保护方法，目前硬盘对于震动有较好的防护力，防摔能力也大幅进步，遇到较大震动时磁头会立刻移到安全区。而1990年代的一些硬盘，若在使用中碰到略大的地震或震动，就很可能损坏。近期的部分硬盘也开始防范突然断电的情况，断电时将磁头自动收回，防止震动使磁头划坏盘片。而许多笔记本电脑厂商也开发出各种笔记本电脑结构来加强硬盘的防摔性。但硬盘在通电时耐摔度会降低、也只能温和的移动；在意外断电后虽然磁盘不会损坏，但可能会发生数据丢失。

硬盘具有极长的寿命，理论值为100年（不工作），一般为5年以上，工作时间一般长于3万小时（作为对照，一台经常开机的笔记本硬盘通电时间为每年5000小时）。但仍有许多硬盘由于震动和不科学的使用习惯而三年内损坏。建议不要随便强制关机，不要在电脑开机时频繁移动电脑，更不要在床上、腿上使用含机械硬盘的笔记本，以延长硬盘的寿命。

### 机械硬盘生产厂商

机型硬盘是由IBM在1956年发明，在1960年代初成为通用式电脑中主要的外部存储设备。曾生产过硬盘的厂商超过二百家，经过大规模并购后，现阶段大部分的硬盘已经只由以下三家企业生产。

    希捷科技（Seagate），包括被收购的
        康诺（Conner）（1996）
        Maxtor（迈拓）（2006）
            包括2000年收购的昆腾硬盘部（Quantum）
        三星电子硬盘部（2013）
    西部数据（Western Digital，WD，西数，威腾电子），包括2011年被收购的
        日立（hitachi global storage technologies、HGST，昱科环球存储股份有限公司，昱科）（日立仍有独立品牌）
            包括2003年被Hitachi收购的IBM硬盘部
    东芝（Toshiba）
        包括2009年被收购的富士通硬盘部（Fujitsu）

2013年全部硬盘的营业额约330亿美元，比2012年的378亿美元下滑了12%。机械硬盘制造被认为是夕阳产业。

### 机械硬盘的参数

#### 尺寸

早期的硬盘为5.25寸，现代硬盘为3.5寸（147mm（长）\*102mm（宽）\*26mm（厚）），多用于台式机、服务器，还有用于笔记本的2.5寸硬盘（100mm*70mm,厚度多为7mm,部分为9.5mm).

#### 转速

硬盘每分钟旋转的圈数，单位是rpm（每分钟的转动数），有4200rpm、5400rpm、5900rpm、7200rpm、10000rpm、15000rpm、18000rpm等几种规格。转速愈高通常数据读写速率愈好，但同时噪音、耗电量和发热量也较高。消费级硬盘多为7200rpm和5400rpm。

#### 盘片数

一块硬盘可以同时包含多个盘片，这是一种快速提升硬盘容量的方法。盘片越多，硬盘越容易收到震动而损坏，且厚度会增大。

#### 单碟容量

每个碟片的容量，常见的为500GB,还有250GB以及较新的1TB。由于硬盘尺寸固定，单碟容量大即代表着存储密度大。同样转速下，存储密度大的硬盘读写速度更高。盘片数\*单碟容量即为硬盘总容量。

#### 缓存

由于机械硬盘只能顺序读写，随机读写效率很差，为了提高写入效率和随机写入速度，现代机械硬盘常含有缓存。缓存容量越大写入性能越好。然而缓存不能无限大，因此机械硬盘长时间随机写入后写入速度会下降。缓存大小一般为32MB或64MB，颗粒为DDR SDRAM（内存颗粒）。

#### 主控芯片

主控芯片控制整个机械硬盘的工作和与计算机的通信。硬盘磁头直接读出的原始数据需要主控芯片进行处理才能发送出去，接口收到计算机的指令和数据需要主控的处理才会发给磁头。主控是一种微处理器，其程序存储在固件ROM中，且需要缓存才能工作。机械硬盘一般还含有专门控制电机的芯片。现代硬盘的主控具有许多高级功能，例如对AHCI的支持和数据校验。主控芯片有性能上的差距，但消费者很难进行比较。

### 接口类型

机械硬盘按数据接口不同，大致分为ATA（IDE）和SATA以及SCSI和SAS。硬盘最常见的接口是SATA接口。接口速度不是实际硬盘数据传输的速度，目前非基于闪存技术的硬盘数据实际传输速度一般不会超过300MB/s。

#### ATA

全称Advanced Technology Attachment，使用40-pin并口数据线连接主板与硬盘，接口速度最大为133MB/s，因为并口线的抗干扰性太差，且排线占用空间较大（80针），不利电脑内部散热，已逐渐被SATA所取代。2002年SATA推出后改名PATA（并行高技术配件，Parallel ATA）。ATA与由集成驱动电子设备（英语：Integrated Drive Electronics，简称IDE）技术实现的磁盘驱动器关系最密切，因此ATA硬盘常称为IDE硬盘。早期的光盘驱动器也采用这种接口。该技术已被淘汰。

#### SATA

全称Serial ATA，也就是使用串口的ATA接口，抗干扰性强，且对数据线的长度要求比ATA低很多（7针），电压较低。SATA-II的接口速度为300MB/s，而SATA-III标准可达到600MB/s（6Gb/s,10bit/8bit校验）的传输速度。SATA的数据线也比ATA的细得多，有利于机箱内的空气流通，整理线材也比较方便。

#### SCSI

全称是Small Computer System Interface（小型机系统接口），经历多代的发展，从早期的SCSI-II，到目前的Ultra320 SCSI以及Fiber-Channel（光纤通道），接口型式也多种多样（50针或68针）。SCSI硬盘广为工作站级个人电脑以及服务器所使用，因此会使用较为先进的技术，和普通IDE硬盘相比有很多优点：接口速度快，并且由于主要用于服务器，因此硬盘本身的性能也比较高，硬盘转速快（如碟片转速15000rpm的高转速），缓存容量大，CPU占用率低，扩展性远优于IDE硬盘，并且支持热插拔，但是单价也比相同容量的ATA及SATA硬盘更加昂贵，很少见，大多被SAS代替。

#### SAS

Serial Attached SCSI，串行小型机接口，是新一代的SCSI技术，继承了SCSI的优秀特点。和SATA硬盘相同，SAS也采取串口技术以获得更高的传输速度，可达到6Gb/s。SAS接口形状与SATA相同，SAS插槽兼容SATA设备，但SATA插槽不能识别SAS设备。SAS主要用于服务器存储。此外，由于SAS硬盘可以与SATA硬盘共享同样的插槽，因此在同一个SAS存储系统中，可以用SATA硬盘来取代部分昂贵的SAS硬盘，节省整体的存储成本。但SATA存储系统并不能连接SAS硬盘。常见于工作站，服务器。

#### 注1：AHCI

高级主机控制器接口，英文：Advanced Host Controller Interface）是一种由英特尔制定的技术标准，它提供软件与SATA存储设备沟通的硬件机制，可让SATA存储设备激活高级SATA功能，例如原生指令队列、帧结构数据交换技术及热插拔。AHCI详细定义一个内存架构规范给予硬件制造商，规范如何在系统内存与SATA存储设备间传输数据。

多数的SATA控制器提供了如下的运行模式：兼容老式PATA接口模拟（IDE模式），标准AHCI模式，以及厂商自定义RAID模式（多数支持AHCI以发挥其性能）。Intel建议在其主板上采用RAID模式来取代AHCI/SATA模式以便获得最大的兼容性，因为RAID模式既兼容SATA又可以使用AHCI的功能，即使只有一块硬盘。IDE模式是一种利用软件途径向后兼容，以此允许SATA控制器在无法识别SATA或驱动不支持的老式操作系统上运行。

#### 注2：并行接口与串行接口的区别

串口具有多个数据传输通道，多位数据同时传输，串口只有2个数据传输通道，数据依次发送。并行接口速度比串行接口速度快，这是若干年前的情况了。在实际时钟频率比较低的情况下，并口因为可以同时传输若干比特，速率确实比串口快。但是，随着技术的发展，时钟频率越来越高，并行导线之间的相互干扰越来越严重。并行接口因为有多条并行且紧密的导线，但时钟频率提高的一定程度时，传输的数据已经无法恢复。而串口因为导线少，线间干扰容易控制，反而可以通过不断提高时钟频率来提高传输速率。而且串口的接口也会比较小。这就是为什么现在高速传输都采用串行方式的原因。

### 寻址

计算机定位硬盘中数据的方式称为寻址。寻址的方式有两种，CHS和LBA。

#### CHS

CHS是硬盘一开始的寻址方式。所谓CHS即柱面（cylinder），磁头（header），扇区（sector），通过这三个变量描述磁盘数据的地址，这种方法也称作是LARGE寻址方式。

    盘面（Platters）：一块硬盘可能由多个碟片，每个碟片上有正反两个面，这个面叫盘面
    磁道（Track）：当磁盘旋转时，磁头若保持在一个位置上，则每个磁头都会在盘面上“划”出一个圆形轨迹，这些圆形轨迹就叫做磁道
    柱面（Cylinder）：不同盘面相同半径的磁道组成柱面。柱面的参数就是半径
    磁头（Heads）：一个盘面上方有一个磁头，参数中的磁头描述了盘面的位置，即哪个碟片的哪一面
    扇区（Sector）：磁道被均分为若干个扇形，每个扇形叫扇区。扇区是硬盘实际存储的最小单位

在该方法下:硬盘容量=磁头数×柱面数×扇区数×扇区大小（一般为512byte）。

#### LBA

过去CHS的方式可以表示磁盘上每个扇区的位置，但磁盘越来越大，已经不能在2字节内表示整个磁盘上的扇区了（2字节的限制见主引导记录MBR章节）。后来厂商把0柱面0磁头1扇区的扇区称为0号扇区，按照先数扇区再数磁头最后数柱面的方式给每个扇区一个编号，直接通过扇区号的方式定位扇区。

可通过以下公式用CHS地址计算LBA地址

    LBA=（柱面号*每柱面磁头数+磁头号）*每磁道扇区数+扇区号-1

LBA地址一般使用16进制表述，如0x07c00

为了保持与CHS模式的兼容，主控可通过逻辑变换算法，提供CHS寻址方式，但只有很老的老版本DOS系统不支持LBA。

### RAID

RAID：独立硬盘冗余阵列（RAID, Redundant Array of Independent Disks），简称磁盘阵列。其基本思想就是把多个相对便宜的硬盘组合起来，成为一个硬盘阵列组，使性能达到甚至超过一个价格昂贵、容量巨大的硬盘。根据选择的版本不同，RAID比单颗硬盘有以下一个或多个方面的好处：增强数据集成度，增强容错功能，增加处理量或容量。另外，磁盘阵列对于电脑来说，看起来就像一个单独的硬盘或逻辑存储单元。RAID分成不同的档次，每种档次都有其理论上的优缺点，不同的档次在两个目标间获取平衡，分别是增加数据可靠性以及增加存储器（群）读写性能。

根据实现模式，分为软件和硬件两种：

    软件磁盘阵列（Software RAID）：主要由CPU处理存储任务，缺点为耗损较多CPU资源运算RAID，优点则是价格偏低。分类有3种：
        基于主板的磁盘阵列：只需要主板支持即可（通常是芯片组内置的RAID功能），不需要任何磁盘阵列卡。若主板损坏，购买同款主板即可重建RAID。
        硬件辅助磁盘阵列：需要一张RAID卡，以及厂商所提供的驱动程序，此类RAID卡仍然通过CPU进行运算。这种RAID较易迁移到其他电脑。RAID功能靠运行于操作系统的厂商驱动程序和CPU运算提供。
        操作系统的RAID功能：Linux、FreeBSD、Windows Server等操作系统内置RAID功能，部分桌面版本的Windows也支持RAID功能。缺点是难以在RAID损坏后恢复。
    硬件磁盘阵列（Hardware RAID）
        RAID卡上内置处理器，不需要服务器的CPU运算。读写性能最快，不占用服务器资源，可用于任何操作系统，也能在系统断电后，通过电池保存剩余读写工作在内存中，等待电力供应恢复后，接着再完成剩余读写作业。缺点是其售价很高，通常只用于RAID 5和RAID 6。
        独立的存储服务器或存储集群，适用于中大型存储环境，通过高速网络与服务器链接。

根据RAID档次，分为一下几种：
<table>
<thead><tr>
<th>RAID档次</th>
<th>最少硬盘</th>
<th>最大容错</th>
<th>可用容量</th>
<th>读取性能</th>
<th>写入性能</th>
<th>安全性</th>
<th>目的</th>
<th>应用产业</th>
</tr></thead><tbody>
<tr>
<td>单一硬盘</td>
<td>(参考)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>无</td>
<td></td>
<td></td>
</tr>
<tr>
<td>JBOD</td>
<td>1</td>
<td>0</td>
<td>n</td>
<td>1</td>
<td>1</td>
<td>无（同RAID 0）</td>
<td>增加容量</td>
<td>个人（暂时）存储备份</td>
</tr>
<tr>
<td>0</td>
<td>2</td>
<td>0</td>
<td>n</td>
<td>n</td>
<td>n</td>
<td>一个硬盘异常，全部硬盘都会异常</td>
<td>追求最大容量、速度</td>
<td>视频剪接缓存用途</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>n-1</td>
<td>1</td>
<td>n</td>
<td>1</td>
<td>最高，一个正常即可</td>
<td>追求最大安全性</td>
<td>个人、企业备份</td>
</tr>
<tr>
<td>5</td>
<td>3</td>
<td>1</td>
<td>n-1</td>
<td>n-1</td>
<td>n-1</td>
<td>高</td>
<td>追求最大容量、最小预算</td>
<td>个人、企业备份</td>
</tr>
<tr>
<td>6</td>
<td>4</td>
<td>2</td>
<td>n-2</td>
<td>n-2</td>
<td>n-2</td>
<td>安全性较RAID 5高</td>
<td>同RAID 5，但较安全</td>
<td>个人、企业备份</td>
</tr>
<tr>
<td>10</td>
<td>4</td>
<td>n/2</td>
<td>n/2</td>
<td>n</td>
<td>n/2</td>
<td>安全性高</td>
<td>综合RAID 0/1优点，理论速度较快</td>
<td>大型数据库、服务器</td>
</tr>
</tbody><tfoot></tfoot></table>

1. n代表硬盘总数
1. JBOD可接到现有硬盘，直接增加容量

其他种类的RAID，见[Wikipedia:RAID](https://zh.wikipedia.org/zh-cn/RAID)

### 发展史

<table>
<tbody><tr>
<th width="100">时间</th>
<th>发展内容</th>
</tr>
<tr>
<td>1956年</td>
<td>IBM的IBM 305 RAMAC是现代硬盘的雏形，它相当于两个冰箱的体积，不过其存储容量只有5MB。</td>
</tr>
<tr>
<td>1973年</td>
<td>这一年IBM 3340问世，它拥有“温彻斯特”这个绰号，来源于它的两个30MB存储单元，恰好是当时出名的“温彻斯特来福枪”的口径和填弹量。至此，硬盘的基本架构被确立。</td>
</tr>
<tr>
<td>1980年</td>
<td>两位前IBM员工创立的公司开发出5.25英寸规格的5MB硬盘，这是首款面向台式机的产品，而该公司正是希捷公司（Seagate）公司。</td>
</tr>
<tr>
<td>1980年代末</td>
<td>IBM推出MR（Magneto Resistive磁阻）技术令磁头灵敏度大大提升，使盘片的存储密度较之前的20Mbpsi（bit/每平方英寸）提高数十倍，该技术为硬盘容量的巨大提升奠定基础。1991年，IBM应用该技术推出首款3.5英寸的1GB硬盘。</td>
</tr>
<tr>
<td>1970年到1991年</td>
<td>硬盘碟片的存储密度以每年25%~30%的速度增长；从1991年开始增长到60%～80%；至今，速度提升到100%甚至是200%。从1997年开始的惊人速度提升得益于IBM的GMR（Giant Magneto Resistive，<a href="https://zh.wikipedia.org/wiki/%E5%B7%A8%E7%A3%81%E9%98%BB">巨磁阻</a>）技术，它使磁头灵敏度进一步提升，进而提高了存储密度。</td>
</tr>
<tr>
<td>1993年</td>
<td>康诺（Conner Peripherals）推出CP30344硬盘容量是340MB。</td>
</tr>
<tr>
<td>1995年</td>
<td>为了配合Intel的LX芯片组，昆腾与Intel携手发布UDMA33接口——EIDE标准将原来接口数据传输率从16.6MB/s提升到了33MB/s同年，希捷开发出液态轴承（FDB，Fluid Dynamic Bearing）电动机。所谓的FDB就是指将陀螺仪上的技术引进到硬盘生产中，用厚度相当于头发直径十分之一的油膜取代金属轴承，减轻硬盘噪音与发热量。</td>
</tr>
<tr>
<td>1996年</td>
<td>希捷收购康诺（Conner Peripherals）。</td>
</tr>
<tr>
<td>1998年2月</td>
<td>UDMA 66规格面世。</td>
</tr>
<tr>
<td>2000年10月</td>
<td>迈拓</a>（Maxtor）收购昆腾</a>。</td>
</tr>
<tr>
<td>2003年1月</td>
<td>日立</a>宣布完成20.5亿美元的收购IBM硬盘事业部项目，并成立日立环球存储科技公司（Hitachi Global Storage Technologies, Hitachi GST）。</td>
</tr>
<tr>
<td>2005年</td>
<td>日立环储和希捷都宣布了将开始大量采用磁盘垂直写入技术</a>（perpendicular recording），该原理是将平行于盘片的磁场方向改变为垂直（90度），更充分地利用的存储空间。</td>
</tr>
<tr>
<td>2005年12月21日</td>
<td>希捷宣布收购迈拓（Maxtor）。</td>
</tr>
<tr>
<td>2007年1月</td>
<td>日立环球存储科技宣布将会发售全球首只1TB的硬盘，比原先的预定时间迟了一年多。硬盘的售价为399美元，平均每美分可以购得27.5MB硬盘空间。</td>
</tr>
<tr>
<td>2011年3月</td>
<td>西部数据</a>以43亿美元的价格，收购日立环球存储科技。</td>
</tr>
<tr>
<td>2011年4月</td>
<td>希捷宣布与三星强化策略伙伴关系，传统的硬盘逐渐地被固态硬盘所取代。</td>
</tr>
<tr>
<td>2011年12月</td>
<td>希捷宣布收购了三星旗下的硬盘业务。</td>
</tr>
</tbody></table>

## 固态硬盘

固态硬盘（Solid State Drives，简称SSD）是使用闪存（NAND FLASH）作为存储介质的存储器，由NAND flash，主控，高速缓存（RAM）组成。其速度明显大于机械硬盘，随机读取延迟极低，功耗低，无噪音，抗震动。虽然名字中有硬盘一词，但SSD并没有硬质盘片，只有一个集成各个芯片的电路板，体积很小。

### SSD接口类型

与机械硬盘不同，固态硬盘在本世纪才开始大规模商用，没有使用古老的并口。由于速度较快，不同公司和组织先后推出了一些接口，有些很流行，有些已经被淘汰，有些只用于服务器领域。

#### SATA 3.0：

作为目前应用最多的硬盘接口，SATA 接口最大的优势就是成熟，兼容的设备多，普及程度也比较高。SATA接口从最初的SATA1.0进化如今的SATA3.0，普通2.5英寸SSD以及HDD硬盘都使用这种接口，理论传输带宽6Gbps，虽然比起新接口的10Gbps甚至32Gbps带宽差多了，但普通2.5英寸SSD也没这么高的需求，500MB/s多的读写速度也够用。而在HDD硬盘上6Gbps带宽远远谈不上瓶颈，谁让HDD硬盘发展太慢，速度一直没有质变。虽然SATA 3.0接口规格已经落伍，但廉颇岁老，尚能饭。普通用户对性能的要求谈不上苛刻，SATA 3.0很长一段时间内都将是主流选择。不过，与笔记本硬盘一样的2.5英寸尺寸，加上拆开后发现还有大量空余空间，于是我们都不禁疑问，为何不能做成小尺寸的SATA SSD？于是就有了mSATA。

#### mSATA接口：

mSATA的历史其实也挺悠久的，“国际SATA协会”在2009年推出了新的Mini-SATA接口控制器下的产品规范。新的控制器可以让SATA技术整合在小尺寸的装置上，同时mSATA将提供跟目前SATA接口标准一样的3Gb/s和6Gb/s的理论接口传输速度。
正因为尺寸小，超薄，节省空间，Intel曾积极为mSATA SSD推广，以其作为超极本等超薄移动PC上的存储设备，并在部分主板上集成了这一接口。由于采用了和SATA 3.0一样的传输标准，性能有所保障，加上小体积，成为了当年不少笔记本电脑双硬盘配置的SSD层面首选。
但mSATA SSD产品推出市场后并不如当初所预想得那般受欢迎。由于面积限制，颗粒数目所限，性能与容量难以匹敌同时代的2.5英寸SSD；同时小尺寸带来价格的昂贵，加上当时SSD发展尚未成熟，容量价格比低，亮点少无法吸引用户购买。最后，mSATA SSD沦落到二手市场抛售的情况。
无论是什么类型的SATA 3.0接口，其速度短板造成的木桶效应越来越明显，市场渴望突破6Gbps带宽的I/O接口来适应用户对高速SSD性能的需求。于是，前几年开启了新接口替代SATA 3.0的节奏。那么，谁将是天选之子？

#### SATA Express：

为了突破SATA3.0的瓶颈，并为以前的SATA设备提供兼容，SATA标准的制定者，SATA协会，拟定了一种新的磁盘接口，称为SATA-Express。（英文：Serial Advanced Technology Attachment Express， Serial ATA Express， SATAe）
顾名思义，SATA-Express是SATA接口  PCI-Express的混合体，SATA Express原生标准使用PCI-e x2通道，其理论带宽达10Gbps，比SATA3.0高了4Gbps，它能兼容SATA标准的老硬盘，包括连接线和接口，也能使用也支持使用AHCI逻辑接口的PCI-e SSD(含义见下文），每个SATA-Express接口可以接1个SATA-Express硬盘，或者2个SATA硬盘。
SATA Express的推广使用上，分为两种情况。单就SATA Express控制器本身而言是算成功的，至2017年推出的主板芯片组、x86 CPU/SoC均有支持。然而就SATA Express物理界面上来说则是相当的失败，以至于主板厂商多是将SATA Express控制器用于SATA插槽或是M.2插槽上，载有SATA Express物理接口的主板可谓是相当的少，只出现于高端台式机主板，且因PCI-e通道有限，使用M.2接口后就无法使用SATAe接口，因此极少使用。在笔记本上，SATA-E的出现并没有改善接口和硬盘体积庞大的事实，因此笔记本上并没有SATA-E的使用。

#### mini PCI-E：

mini-PCI-E接口曾是适用于笔记本的PCI-E接口，速率为PCI-e x2，其外形与mSATA相同但完全不能相互兼容。但笔记本上其实并没有多少PCI-E可以插入，显卡放不下，只能放一个无线网卡。SSD流行后，mSATA接口限制了笔记本上SSD的速度，因此部分厂商把mSATA换成了大小一样的mini PCI-E。速度解决了，但容量并没有解决。当时只有60G的容量售价却几百元，使得人们的购买欲望很差。此外很小的体积导致较高的温度，导致SSD速度骤降，很影响体验。在M.2出现后，mini PCI-E的网卡和SSD一同进入了历史的垃圾场。

#### M.2 接口：

羊毛出于羊身上，在英特尔主推超极本的时代，就已经颁布了适应超薄空间的存储接口标准以及对应的SSD设计标准。由于mSATA诸多弱点不得不让Intel重新定位理想框架下存储设备，Intel也认识到mSATA接口和mini PCI-e并不能满足目前的发展需求，在2012年的IDF上，提出将开始大力推广NGFF（Next Generation Form Factor）技术标准的SSD，通过进一步降低厚度同时提高传输速度满足新一代超极本的需求。M.2标准允许更长的模块和双面组件群，M.2 SSD设备可以提供更大的存储容量，与mSATA设备占用同样空间，但提供双倍的存储容量。

由于NGFF不够言简意赅，后来改名成M.2接口。相比SATA接口，M.2接口在传输带宽、容量、轻薄特性等方面有更多的优势。现在，M.2接口不再只局限于超极本上，在DIY装机领域同样来势汹汹。早在Intel 9系主板上就配有M.2接口，到100系列主板，几乎成为了标配。

为什么M.2能够引领小型SSD的速度革命？原因在于M.2接口可以走PCI-E通道，而非传统的SATA通道。我们知道，主流的CPU都有充裕的PCI-E通道数，PCI-E直接与CPU通信，速度比SATA高得多,SATA连接到主板的芯片组，需要转换才能将信息发往CPU，带宽小，延迟大。

M.2接口除了走PCI-E高速通道来实现超高传输速度外，还需要解决机械硬盘遗留下来的延时问题（速度与延时是硬盘的量大性能指标）。我们知道，造成硬盘存储时延迟的三大因素，存储介质本身、控制器，以及软件接口标准。NAND与PCI-E控制器改善了前两点，而改善最后一点的，就是为取代AHCI而生NVMe。

AHCI目标是为比内存CPU慢的多的基于旋转磁介质的存储器与CPU通信设计的规范，但SSD的行为更加类似于内存而不是旋转介质（机械硬盘），因此SSD使用AHCI会有延迟高等低性能问题

##### NVMe传输协议

NVM Express，全称Non-Volatile Memory Host Controller Interface Specification， “非易失性内存主机控制器界面规范”，就是基于闪存的特点而研发的全新传输协议，比AHCI更懂SSD。NVMe的队列数量从AHCI的1，提高了64000，大幅提高了SSD的IOPS（每秒读写次数）性能，提供低延迟并行性的特点；同时加入了自动功耗状态切换、动态能耗管理功能、免驱功能等等。

综合起来，使用PCI-e通道，NVMe标准的M.2 SSD性能远超目前任何一款接口标准的SSD，比如三星950PRO 256G M.2 SSD，读写性能就达到恐怖的2300MB/s与951MB/s，远远把SATA SSD抛开。

绝大多数M.2接口使用PCI-e通道的SSD都支持NVMe协议，只有少数不支持。但NVMe固态为了兼容早期的操作系统（如Windows8 Windows7及以前的版本，Linux 3.x 2.x),可以在ACHI协议下工作。安装完操作系统后再安装补丁和驱动即可自动启用NVMe。Windows8.1 与 Windows10自带NVMe驱动，但建议安装厂商的驱动以获得更好的性能。Linux建议先升级内核至4.0以上再安装系统。

#### PCI-E 接口：

M.2 的流行原因除了小巧的接口，还有其强大的性能，而驱动其性能的就是PCI-E通道。作为原来唯一能直接和CPU通信的外部接口，PCI-E的原生接口比M.2更早的用于连接高性能SSD，而M.2只是缩小了PCI-E接口的体积。Intel 750 系列 SSD发售后，读2.5GB/s ,写1.3GB/s的速度吓坏了大家。而Intel 750使用的接口就是PCIE-x8，与显卡一样的体积保证了散热，但另一方面，推出大体积的固态就会损失小机箱的用户，因此厂商还推出了M.2转PCI-E卡，以满足土豪想插4条SSD的愿望。在服务器方面，PCI-E 接口SSD就比较常见，毕竟服务器需要散热，又不在意体积。大部分PCI-E固态使用了NVMe协议，只有早期的不支持NVMe。

#### U.2 接口：

U.2接口，原先叫SFF-8639，由Intel一手推动。由SATA Express升级而来。它使用了2个SATA 6Gbps接口和一个只有4pin针脚的mini版SATA接口组成，其中小接口只能接入PCI-E线，这样做的最大好处就是保持向下兼容，因为目前SATA E硬盘的数量实在是太少太少了。U.2从SATA-e的PCI-E x2变成了PCI-E 3.0 x4，理论传输速度高达32Gbps，此外还增加了许多新协议支持，比如NVMe，这些都是SATA E接口不具备的。可以说，U.2其实才是SATA E的完全体。
U.2的设备端接口融合SATA及SAS接口的特点，中间用针脚填满SATA接口留下的空缺，并预留了L型防呆设计，所以可以兼容SATA、SAS及SATA E规范，主板那一端则是mini SAS（SFF-8643)接口，设备端的U.2线则是一端接在SATA电源上，一端接在U.2硬盘的数据口上。
虽然设计思路与M.2类似，与M.2不同的是，U.2面向的是大尺寸的硬盘。支持SAS等特性使得U.2更多的用于服务器而不是M.2面向的笔记本与台式机。由于消费领域Intel主推M.2，所以我们很少见到U.2的SSD。前面提到的Intel 750有U.2的版本。

#### DIMM 接口：

很多人并没有听说个DIMM接口，但大家应该听说过内存条。DIMM就是台式机内存条的接口。使用内存条接口的固态其目标也是为了取代易失性闪存DDR SDRAM。2017年Intel随kabylake推出的傲腾Optane就有DIMM版（还未上市），不过就其M.2和PCI-E版的表现来看，实用性不大，仅能作为加速机械硬盘写入的闪存罢了。但其没有NAND需要的擦除-写入操作，所以可以原地写入，所以不需要GC，也没有写放大，写入性能曲线异常平滑，长寿命，优越的IOPS（每秒随机读写数），我们只能期望此技术尽快成熟吧。

#### USB接口（type A、type-c、micro-B USB 3.0）

高端U盘使用SSD的结构而不是传统U盘的结构，具有更好的性能和寿命。

### M.2接口详解

前身为Next Generation Form Factor (NGFF) ，是一种计算机内部扩展卡及相关连接器规范。它采用了全新的物理布局和连接器，取代了PCI Express Mini Card及mSATA标准。M.2具有灵活的物理规范，允许更多种类的模块宽度与长度，并与更高级的接口相配。

计算机总线将M.2连接器转化为PCI Express 3.0（最多4个通道）、Serial ATA 3.0和USB 3.0接口。接口的支持取决于设备制造商的选择。M.2连接器有几种不同的固定槽，每种槽有特定的接口，代表着M.2模块不同的功能，避免用户将M.2模块插入到功能不兼容的插槽中。

M.2插槽有不同的缺口形状，常见两种类型：
    B key （也叫Socket2）（可传输 PCIe×2、SATA、USB 2.0、USB 3.0、音频和SMBus）
    M key （也叫Socket3）（可传输 PCIe×4、SATA和SMBus），

M.2卡金手指有三种：B key，M key，B&M key。
    B&M型M.2元件，可最多使用两个PCI Express通道并同时提供对M key和B key兼容性，
    B型M.2最多使用两个PCI Express通道
    M型M.2最多使用四个PCI Express通道；
B key 、M key、B&M key也可提供对SATA存储设备的兼容。

一般来讲，笔记本使用M型插槽较多，SATA固态一般是B&M型针，而NVMe固态使用M型针。B key插槽见于早期的台式机主板和寨板，或者有多个M.2接口的移动CPU笔记本（如小米笔记本）。（蓝天的桌面CPU笔记本允许两个PCI-e x4固态，其他的高端移动CPU笔记本却又有两个PCI-e固态的使用的是主板RAID技术）

M.2SSD分类：
    M key PCI-e X4 NVMe 固态，贵，如SM961，960pro,600p,t10
    B&M key PCI-e X2 NVMe固态，少见，如浦科特M6e
    B&M key SATA固态，最多见，速率小于600MB/s
    B key，基本见不到了。。。

注意，标准允许接口同时支持SATA和PCI-e两种通道，但主板并不一定支持。例如现有的M.2 B key插槽基本上只支持B&M SATA固态，有的M.2 M key插槽只支持PCI-e通道。有的台式机主板在使用SATA Express后M.2插槽就不能使用

此外较新的笔记本网卡也使用M.2接口，接口形状为A key，PCI-e X2通道

M.2元件可以选用不同的尺寸标准，对于笔记本常用的M key，宽度为22mm，长度有42mm,60mm,80mm。分别称为2242，2260，2280。 2242，2260用于超级本SSD，2280的SSD最常见。A key的2230常用于无线网卡.

### 非易失性存储器

（英语：non-volatile memory，缩写为NVRAM）是指当电流关掉后，所存储的数据不会消失的存储器。非易失性存储器中，依存储器内的数据是否能在使用时随时改写为标准，可分为二大类产品，即ROM和Flash memory。不像硬盘和软盘，NVRAM的写入比读取要困难，一般称写入为编程。可编程NVRAM需要擦除后才能编程，且有擦除次数寿命。

#### ROM简介

ROM，Read-only memory，只读内存，是一种半导体存储器，分为以下几类。

    1.Mask ROM，最早的ROM，其特性是一旦生产出来数据就无法再将之改变或删除。
    2.PROM（Programmable read-only memory，可编程只读内存）将ROM中的焊点由熔丝代替。一个典型的PROM一开始时每个比特都会是1，生产后再进行编程。编程中如将该比特的熔丝烧断则成为0（通常加以高压），这一过程是不可逆的（即刻录后不能再改变），断电后也不会消失记忆。常用于生产Mask ROM前的测试。由美国导弹制导科学家周文俊发明。
    3.EPROM（Erasable programmable read only memory，可擦可编程只读内存）由以色列工程师Dov Frohman发明，是一种断电后仍能保留数据的计算机存储芯片。它是一组浮栅晶体管，若提供比读取电压更高的电压即可进行编程，编程需要编程器。一旦编程完成后，EPROM只能用强紫外线照射来擦除。通过封装顶部能看见硅片的透明窗口，很容易识别EPROM，这个窗口同时用来进行紫外线擦除。Intel 1702 是全球最早的 EPROM 。曾用于BIOS程序的存储。
    4.EEPROM（Electrically erasable programmable read only memory，电可擦可编程只读内存）是一种可以通过电子方式多次复写的半导体存储设备。相比EPROM，EEPROM的擦除不需要借助于其它设备，它是以电子信号来修改其内容的，而且是以Byte为最小修改单位，不必将资料全部洗掉才能写入，彻底摆脱了EPROM Eraser和编程器的束缚。1978年，Intel公司的George Perlegos在EPROM技术的基础上，改用薄的闸极氧化层，以便无需紫外光，芯片就可以用电气方式抹除自身的比特，开发出型号为2816的16kbit EEPROM。Perlegos与一些同事后来离开Intel，创立 Seeq Technology 公司后，在芯片上内置电荷泵（charge pump）以提供刻录时自身所需的高电压，因而推出只需5V电压的EEPROM，利于实施在线刻录。用于许多硬件的固件存储，也是早期U盘的存储颗粒。

#### 闪存介绍

闪存（无论是NOR型或NAND型）是舛冈富士雄博士在1984年于东芝公司工作时发明。舛冈博士在1984年的加州旧金山IEEE国际电子组件会议（International Electron Devices Meeting, IEDM）上发表了这项发明。Intel看到了这项发明的巨大潜力，并于1988年推出第一款商业性的NOR Flash芯片。东芝在1989年的国际固态电路研讨会（ISSCC）上发表了NAND Flash。

FLASH ROM在使用上很类似EEPROM，事实上，二者还是有差别的。FLASH ROM在擦除时，也要执行专用的刷新程序，但是在删除资料时，并非以Byte为基本单位，而是以Block为最小单位，Block的大小随厂商的不同而有所不同；只有在写入时，才以Byte为最小单位写入；FLASH ROM芯片的读和写操作都是在单电压下进行，不需跳线，只利用专用程序即可方便地修改其内容；FLASH电路结构简单，成本低，存储容量普遍大于EEPROM，但初期flash擦除次数（1万-10万）不如EEPROM（10万-100万）。flash器件的写入操作只能在空或已擦除的单元内进行，所以大多数情况下，在进行写入操作之前必须先执行擦除。

FLASH Memory分为NOR型和NAND型。NOR和NAND型闪存由记忆单元间的内部连接结构而得名。NOR型与NAND型闪存的区别很大。

NOR型闪存更像内存，每个存储单元都有独立的地址线，存储单元以平行方式连接到数据线，这种存储单元的平行连接类似于CMOS NOR闸中的晶体管平行连接。NOR闪存可以单独读取一比特的数据，可以随机存取存储器上的任何区域，但价格比较贵，容量比较小。NOR Flash需要很长的时间进行抹写，可以忍受一万到一百万次抹写循环。

而NAND型更像硬盘，地址线和数据线是共用的I/O线，类似硬盘的所有信息都通过一条硬盘线传送一般。NAND闪存内部存储单元以顺序方式连接，类似于NAND闸。NAND型与NOR型闪存相比，顺序连接方式所占空间较平行连接方式为小（每个存储单元的面积约为NOR的50%-60%），这让NAND Flash相较于NOR Flash具有较高的存储密度与较低的每比特成本。NAND Flash具有较快的抹写时间，同时它的可抹除次数也高出NOR Flash十倍。然而NAND Flash的I/O接口并没有随机存取外部地址总线，它必须以区块性的方式进行读取，NAND Flash典型的区块（也称为页）大小是数百至数千比特。CPU不能直接读取NAND Flash，必须有特定的读取程序。

NOR型与NAND型闪存最主要的两个差异点如下：

    连接单个存储单元的方法不同（类似逻辑电路的NOR与NAND）
    读写存储单元的接口不同（NOR型闪存有地址线，而NAND型闪存只能按页访问）

以上两点是相关的NAND型闪存研发所做出的设计抉择。NOR目标是EEPROM的替代品，而NAND型闪存目标是为了减少所需的芯片面积来实现给定的闪存容量，从而降低每比特的成本，并推升芯片最大容量，如此就可与磁性存储设备相互竞争，如硬盘。

由于EEPROM常用在硬件固件上，与微处理器一起工作，因此NOR必须支持按字节的访问与随机读取，即含有独立地址线，这也是NOR型闪存容量小、擦除慢的原因。NOR可以直接使用，并在上面直接运行代码，此特点称为芯片内执行(XIP, eXecute In Place),这样应用程序可以直接在flash闪存内运行,不必像硬盘一样再把代码读到系统RAM中。即CPU的取指令模块可直接送地址到NOR地址总线从NOR数据总线中获得数据和指令，且读取速度和RAM，ROM相近（100ns）。NOR型闪存面世后，成为比现有的EPROM与EEPROM内存更经济、更方便的可擦除只读内存。然而，NOR型闪存其内含的写入电路是相当慢的，并且只提供区块抹除功能。擦除NOR器件时是以64～128KB的块进行的，执行一个写入/擦除操作的时间为5s ，与此相反，擦除NAND器件是以8～32KB的块进 行的，执行相同的操作最多只需要4ms。

在取代硬盘方面，NOR极慢的擦除速度和较小的容量成了最大的缺点，而随机读取和芯片内执行对硬盘并没有用处。因此去除地址线并发明NAND也就水到渠成了。取而代之的是，外部设备可使用顺序访问命令与数据寄存器与NAND型闪存沟通，由内存内部获取所需数据并将其输出。选择这种设计方式使得NAND型闪存无法随机存取，降低了写入速度，但是NAND型闪存的主要目标是取代硬盘，而不是可擦除只读内存。由于NAND的顺序结构简单，擦除电路也很简单，去除地址线后NAND也获得了快速擦除的优点，同时还有较大的存储密度。但是NAND的实际应用方式要比NOR复杂的多，NAND不仅读取的时序复杂（共用地址、数据、命令总线），而且取出的数据是基于扇区的，速度较慢（微秒级），且NAND很容易发生坏块或位反转，需要独立的校验和自始至终的虚拟映射，并对坏块进行管理。因此NAND通常需要主控芯片操作NAND并接收外部的指令。CPU不能直接获取NAND芯片的数据。

韩国的三星电子(Samsung Electronics)和海力士(Hynix)，美国的美光科技(Micron Technology)及日本东芝垄断了全球90%的NAND闪存存储器市场。

#### NAND提高存储密度的制造技术

##### 制程

制程即互补氧化物金属半导体场效应晶体管栅极的宽度，制程越先进（越小），每个存储单元便也越小，并且越省电。不同于CPU的是，在16nm以内，制程越先进，NAND不一定越好。过小的栅长会导致断电时电子由于量子效应而流失，导致数据丢失，而CPU工作时不断有电流流过，漏电很少发生。现在的NAND制程普遍落后CPU 1-2代，且NAND制造大厂基本上已经停止对先进制程的研发，除非有创造性的技术能防止漏电的发生。现代的固态长时间断电存放在高温环境（50°C以上）一段时间（数月)数据便完全损坏。

##### MLC技术

传统上，每个存储单元内存储1个信息比特，称为单阶存储单元（Single-Level Cell,SLC），使用这种存储单元的闪存也称为单阶存储单元闪存（SLC flash memory），或简称SLC闪存。这种单元中只有2个电子状态，有电为1，没电为0.很少有消费级SLC存储。SLC一般能有50000到100000次循环.

而多阶存储单元（Multi-Level Cell,MLC）可以在每个存储单元内存储2个以上的信息比特，其“多阶”指的是电荷充电有多个能阶（即多个电压值），如此便能存储多个比特的值于每个存储单元中。MLC闪存具有较高的数据密度和较低的单元存储成本，但比起SLC闪存，更容易发生误码。为了实现对多种状态的控制和判断，MLC的读写速度较慢，功耗较高，可编程擦写周期（P\E)较低，但存储密度可以翻倍提升。2016年2月的一项研究表示，SLC与MLC的可靠性在实践中几乎没有差异。通常称的MLC为2阶单元，即有4种状态：0，1，2，3.MLC一般只有3000至5000次循环.

三阶储存单元（Triple-Level Cell, TLC），即3阶存储单元，每单元存储8种状态，0-7。TLC更不稳定，寿命较短（1000次擦写），写入更慢。但在优秀主控、多通道、模拟SLC等技术的作用下，TLC的寿命、速度不输MLC与SLC。主控的作业见后文。多通道，即多个闪存芯片同时读写，速度即可翻倍。模拟SLC，即在TLC闪存占用容量较少时，把TLC８阶状态转换为４阶状态或２阶状态，以获得更快的读写速度和更低的误码率。2013年7月上市的三星840EVO是第一款TLC固态。

关于TLC的可靠性，有一个测试。连续随机4K写入TLC颗粒的NVMe入门级固态600p（256GB版）50天后，固态变为只读状态，写入量为106TB。600p官方保修5年，日常使用600P（512GB版）每月写入量最多为1TB，则寿命约为13年。

QLC，四阶储存单元，尚在实验室中测试，预计2018或2019年会上市。

##### 3D堆叠

传统的半导体芯片为2维的。由于NAND结构结构简单，先进的NAND闪存制造商可以将电路堆叠称3维结构。目前48层3D NAND已经量产，东芝实验室中已经实现96层堆叠，预计2018年量产，单die容量1TB（TLC）、1.5TB（QLC）。2016年NAND涨价原因就是3大NAND厂商新建的3D NAND产线良率太低，而3大厂商没有扩建老产线的意图，但手机方面的需求量很大，供不应求。3大NAND厂默契地决定涨价。

#### 闪存的缺陷

##### 按区块抹除：

闪存的一种限制在于即使它可以单一字节的方式读或写入，但是抹除一定是一整个区块。一般来说都是设置某一区中的所有比特为“1”，刚开始区块内的所有部分都可以写入，然而当有任何一个比特被设为“0”时，就只能借由清除整个区块来恢复此比特“1”的状态。换句话说闪存（特别是NOR Flash）能提供随机读取与写入（由１到０）操作，却无法提供任意的随机改写（由０到１）。

##### 读取干扰：

所使用的闪存读取方式随着时间的推移会导致在同一区块中相近的记忆单元内容改变（使读取变成写入动作）。这即是所谓的读取干扰。会导致读取干扰现象的读取次数门槛介于区块被抹除间，通常为100,000次。假如连续从一个记忆单元读取，此记忆单元将不会受损，而受损却是接下来被读取的周围记忆单元。为避免读取干扰问题，闪存控制器通常会计算从上次抹除动作后的区块读取动作总次数。当计数值超过所设置的目标值门槛时，受影响的区块会被复制到一个新的区块，然后将原区块抹除后释放到区块回收区中。原区块在抹除动作后就会像新的一样。若是闪存控制器没有即时介入时，读取干扰错误就会发生，如果错误太多而无法被ECC机制修复时就会伴随着可能的数据丢失。

##### 区块耗损与损坏：

另一项闪存的限制是它有抹写循环的次数限制。临近循环次数后，区块便很容易出现错误，如无法擦除，读取缓慢，之后会彻底失去响应，这个区块便成为坏块。NAND生产出来时就带有坏块，在出厂前会先剔除。由于NAND坏块率明显高于NOR，NAND自始至终需要主控进行地址虚拟映射，即将逻辑地址映射到真实的区块上。

##### 写入（编程）干扰：

写入干扰（编程干扰）是指当对页（page）进行写入时，由于阈值电压接近的关系，相邻的位（bit）也被升高，从而造成相邻的位出错。闪存电荷非常不稳定，相邻存储电荷的悬浮门间会相互干扰，造成相邻悬浮门间的bit错误，MLC由于存在4组接近的电压，与SLC相比更容易受到干扰。

##### 位交换：

所有flash器件都受位交换现象的困扰。在某些情况下（很少见，NAND发生的次数要比NOR多），一个比特位会发生反转或被报告反转了。一位的变化可能不很明显，但是如果发生在一个关键文件上，这个小小的故障可能导致系统停机。如果只是报告有问题，多读几次就可能解决了。当然，如果这个位真的改变了，就必须采用错误探测/错误更正(EDC/ECC)算法。位反转的问题更多见于NAND闪存，NAND的供应商建议使用NAND闪存的时候，必须使用EDC/ECC算法。这个问题对于用NAND存储多媒体信息时倒不是致命的。但是，如果用NAND存储设备来存储操作系统、配置文件或其他敏感信息时， 必须使用EDC/ECC系统以确保可靠性。

##### 损坏时的不可挽救性：

当负责存储数据的闪存颗粒有毁损时，现在的数据修复技术不可能在损坏的芯片中救回数据，相反传统机械硬盘或许还能通过一些数据恢复技术挽回一些数据。

### SSD主控

现有的SSD基于NAND flash，因此需要主控进行管理才能与主机通信。优秀的主控能使SSD获得较高的速度，较好的可靠性与较长的寿命。

闪存主控由RISC微处理器、RAM等芯片组成。

以下为主控的一些功能。

#### 初始化与安全擦除

在闪存存储设备最初被制造出来的时候，闪存控制器首先会格式化闪存才能投入到工作中。因制作工艺问题，任何闪存制成时都或多或少有坏的记忆体单元，为确保设备运行正常，控制器能检测出已坏不能工作的快闪记忆体单元，并分配备用单元将坏的单元取代。出厂时，控制器会指定某些部分的单元用于存储固件驱动、特定存储设备的操作格式和控制器其它特殊功能等。闪存控制器接着会创建映射目录，以实现虚拟映射的功能。闪存在使用后也可以手动初始化，这被称为安全擦除，安全擦除后数据将完全丢失，对于拥有芯片级加密的主控，安全擦除后会生成新的密钥。安全擦除后，闪存的读写性能可能会得到提升，但所有块的擦除次数会增加。

#### 低级访问

NAND Flash所有的动作都必须以区块性基础（Block-wise fashion）运行，包含读、写、解锁与抹除，这种内存的访问方式类似硬盘之类的区块性存储设备，每个区块由数个页所构成。一般来说这些页的大小为512或2048或4096字节。在各个页之间彼此的连接区域会有几个字节（一般而言是数据大小的1/32），这些空间用于存储错误修正码的校验和。以下是一些典型的区块大小：
    每32个512+ 16字节的页为1个大小是16KB的区块
    每64个2048+ 64字节的页为1个大小是128KB的区块
    每64个4096+128字节的页为1个大小是256KB的区块
    每128个4096+128字节的页为1个大小是512KB的区块
读取与写入动作可以以“页”为单位偏移量进行，只能序列性的写入，抹除动作只能以“区块”为单位偏移量进行。要写入时，写入的页必须已经擦除。

当系统或设备需要读取数据或将数据写入到闪存，它会与闪存控制器进行沟通，由闪存控制器完成逻辑地址（LBA）到块的映射（虚拟映射），当新的数据要替换已写入的旧数据时，SSD控制器将会写入新的数据至新的位置，并且更新逻辑映射，将其指向新的物理位置。原位置的数据将不再有效。在可以再次写入之前，它需要先被擦除。

高性能NAND闪存设备常常含有多块NAND 闪存，类似与机械硬盘的RAID原理。这会加快闪存的读写速度，但对主控的运算能力有较高要求。

#### 坏块管理与虚拟映射

主控会检测是否有区块已经无法擦除、无法写入或无法读取。当出现坏块时，控制器会尝试恢复坏块的数据并将坏块从可用块的列表中剔除。控制器会将可用块中大部分分配LBA地址供主机使用，小部分用于主控数据、存储校验数据或备用。

#### 错误检测与纠正

错误检测与纠正常用在通信领域，因为通信常常因噪声而不可靠。同样NAND存储数据与读取数据的过程也不可靠，因此此技术也用于NAND闪存。

在计算机科学和通信的信息论和编码理论应用中，错误检测和纠正（英语：error detection and correction）或错误控制（error control）是在不可靠的通信信道上可靠地传送数字数据的技术。许多通信信道会经受信道噪声，并因此可能在源至接收器的传输期间引入错误。错误检测技术能够检测这样的错误，而错误纠正能在不少情况下重建原始数据。

##### 纠错码（ECC）

前向纠错（ECC）或前向纠错（FEC）码是一种添加信息冗余数据或奇偶校验数据到消息的过程，使得即使在传输或存储中发生多个错误，接收方也可以用它恢复（不能超过编码本身的能力限制）。因为接收方不必要求发送方重传数据，在前向纠错中不需要反向信道，并因此适合诸如广播等单边通信。纠错码经常用于底层通信，以及用于诸如CD、DVD、硬盘和RAM等介质中的可靠存储。

纠错码经常区分为卷积码与分组码：

    卷积码是逐比特处理。它特别适合于硬件，并且Viterbi解码器允许译码方法。
    分组码是以逐块为基础。分组码的早期例子有重复码、汉明码和多维奇偶校验码。在它们之后是一些更有效的代码，里德-所罗门码因为其最显着所以目前被广泛使用。Turbo码和低密度奇偶检查码（LDPC）相对较新的方法，可以提供几乎最佳的效率。

香农定理是前向纠错的一个重要定理，并且描述了在具有特定错误概率或信噪比（SNR）的信道上可进行可靠通信的最大信息速率。这个严格的上限以信道容量表示。所允许的实际最大码率取决于所使用的纠错码，并可能更低。这是因为香农的证明只是存在性的，并没有显示如何构建代码是为最优并具有高效的编码和解码算法。

#### 写入放大

写入放大（英语：Write amplification，简称WA）是闪存和固态硬盘（SSD）中一种不良的现象，即实际写入的物理数据量是写入数据量的多倍。

写入放大倍数=闪存写入的数据量 ÷ 主控写入的数据量

由于闪存在可重新写入数据前必须先擦除，而擦除操作的粒度与写入操作相比低得多，执行这些操作就会多次移动（或改写）用户数据和元数据。因此，要改写数据，就需要读取闪存某些已使用的部分，更新它们，并写入到新的位置，如果新位置在之前已使被用过，还需连同先擦除；由于闪存的这种工作方式，必须擦除改写的闪存部分比新数据实际需要的大得多。此倍增效应会增加请求写入的次数，缩短SSD的寿命，从而减小SSD能可靠运行的时间。增加的写入也会消耗闪存的带宽，此主要降低SSD的随机写入性能。许多因素会影响SSD的写入放大，一些可以由用户来控制，而另一些则是数据写入和SSD使用的直接结果。

<table>
<caption>写入放大因素</caption>
<thead><tr>
<th style="width: 7em;" class="headerSort" tabindex="0" role="columnheader button" title="升序">因素</th>
<th class="headerSort" tabindex="0" role="columnheader button" title="升序">描述</th>
<th style="width: 5em;" class="headerSort" tabindex="0" role="columnheader button" title="升序">类型</th>
<th style="width: 7em;" class="headerSort" tabindex="0" role="columnheader button" title="升序">关系*</th>
</tr></thead><tbody>
<tr>
<td><a href="https://zh.wikipedia.org/zh-cn/%E5%86%99%E5%85%A5%E6%94%BE%E5%A4%A7#.E5.9E.83.E5.9C.BE.E5.9B.9E.E6.94.B6" title="写入放大">垃圾回收</a></td>
<td>用来挑选用于擦除和重写的最佳块的算法的效率</td>
<td style="background: lightblue;">变量</td>
<td style="background: lightgreen;">反（减小，好）</td>
</tr>
<tr>
<td><a href="https://zh.wikipedia.org/zh-cn/%E5%86%99%E5%85%A5%E6%94%BE%E5%A4%A7#.E9.A2.84.E7.95.99.E7.A9.BA.E9.97.B4" title="写入放大">预留空间</a></td>
<td>分配到SSD控制器的物理容量百分比</td>
<td style="background: Lightblue;">变量</td>
<td style="background: Lightgreen;">反（减小，好）</td>
</tr>
<tr>
<td>SATA的<a href="https://zh.wikipedia.org/zh-cn/TRIM" class="mw-redirect" title="TRIM">TRIM</a>命令 或 SCSI中的UNMAP</td>
<td>这些命令必须由操作系统（OS）发送，可以通知存储设备哪些扇区含有无效数据。可以处理这些命令的SSD能在擦除块时，将包含这些扇区的页作为空闲空间回收，而不是复制无效的数据到干净的页中。</td>
<td style="background: Wheat;">开关</td>
<td style="background: Lightgreen;">顺（减小，好）</td>
</tr>
<tr>
<td><a href="https://zh.wikipedia.org/zh-cn/%E5%86%99%E5%85%A5%E6%94%BE%E5%A4%A7#.E7.A9.BA.E9.97.B2.E7.94.A8.E6.88.B7.E5.AE.B9.E9.87.8F" title="写入放大">空闲用户容量</a></td>
<td>没有实际用户数据的用户容量百分比；需要TRIM，否则SSD不会从空闲容量中获得好处，因为SSD认为这些容量仍有数据</td>
<td style="background: Lightblue;">变量</td>
<td style="background: Lightgreen;">反（减小，好）</td>
</tr>
<tr>
<td><a href="https://zh.wikipedia.org/zh-cn/%E5%86%99%E5%85%A5%E6%94%BE%E5%A4%A7#.E5.AE.89.E5.85.A8.E6.93.A6.E9.99.A4" title="写入放大">安全擦除</a></td>
<td>擦除所有的用户数据和相关元数据，将SSD的性能重置到最初状态（直至重新开始垃圾回收）</td>
<td style="background: Wheat;">开关</td>
<td style="background: Lightgreen;">顺（减小，好）</td>
</tr>
<tr>
<td><a href="https://zh.wikipedia.org/zh-cn/%E5%86%99%E5%85%A5%E6%94%BE%E5%A4%A7#.E8.80.97.E6.8D.9F.E5.9D.87.E8.A1.A1" title="写入放大">耗损均衡</a></td>
<td>算法的效率，令每块的写入次数与其他的块尽可能相同</td>
<td style="background: Lightblue;">变量</td>
<td style="background: LightCoral;">正（增加，坏）</td>
</tr>
<tr>
<td><a href="https://zh.wikipedia.org/zh-cn/%E5%86%99%E5%85%A5%E6%94%BE%E5%A4%A7#.E9.9D.99.E5.8A.A8.E6.95.B0.E6.8D.AE.E5.88.86.E7.A6.BB" title="写入放大">静动数据分离</a></td>
<td>将数据按修改频率分组</td>
<td style="background: Wheat;">开关</td>
<td style="background: Lightgreen;">顺（减小，好）</td>
</tr>
<tr>
<td><a href="https://zh.wikipedia.org/zh-cn/%E5%86%99%E5%85%A5%E6%94%BE%E5%A4%A7#.E9.A1.BA.E5.BA.8F.E5.86.99.E5.85.A5" title="写入放大">顺序写入</a></td>
<td>理论上，顺序写入的写入放大为1，但其他因素仍会影响此值</td>
<td style="background: Wheat;">开关</td>
<td style="background: Lightgreen;">顺（减小，好）</td>
</tr>
<tr>
<td><a href="https://zh.wikipedia.org/zh-cn/%E5%86%99%E5%85%A5%E6%94%BE%E5%A4%A7#.E9.9A.8F.E6.9C.BA.E5.86.99.E5.85.A5" title="写入放大">随机写入</a></td>
<td>写入到非连续的LBA对写入放大的影响最大</td>
<td style="background: Wheat;">开关</td>
<td style="background: LightCoral;">逆（增加，坏）</td>
</tr>
<tr>
<td><a href="https://zh.wikipedia.org/zh-cn/%E6%95%B0%E6%8D%AE%E5%8E%8B%E7%BC%A9" title="数据压缩">数据压缩</a>，包括<a href="https://zh.wikipedia.org/zh-cn/%E9%87%8D%E5%A4%8D%E6%95%B0%E6%8D%AE%E5%88%A0%E9%99%A4" title="重复数据删除">重复数据删除</a></td>
<td>数据压缩和重复数据删除能消除更多的冗余数据，降低写入放大，同时提升SSD速度。</td>
<td style="background: Lightblue;">变量</td>
<td style="background: Lightgreen;">反（减小，好）</td>
</tr>
<tr>
<td>以<a href="https://zh.wikipedia.org/zh-cn/%E5%A4%9A%E5%B1%82%E5%8D%95%E5%85%83#.E5.8D.95.E5.B1.82.E5.8D.95.E5.85.83" title="多层单元">SLC</a>模式使用<a href="https://zh.wikipedia.org/zh-cn/%E5%A4%9A%E5%B1%82%E5%8D%95%E5%85%83" title="多层单元">MLC</a> NAND</td>
<td>以每单元1位，而不是以设计的每单元位数（通常为每单元2位）写入数据，以加快读取和写入操作。如果临近SLC模式下的NAND容量限制，SSD必须把旧有用SLC模式写入的数据改写为MLC或TLC模式，才能让SLC模式的NAND空间释放出来，以便容纳更多的数据。然而，通过让经常更改的页面维持在SLC模式，而不是以MLC或TLC模式修改，这种做法也可以降低磨损，因为比用SLC模式，用MLC或TLC模式写入对闪存的伤害确实更大。因此，这种做法提高了写入放大，但当写入模式设为向常写页面上写入时，却可以减少磨损。然而，顺序和随机写入却会加剧磨损，因为这样就没有或少有频繁写入的页是SLC模式，迫使旧数据不断地从SLC模式改写到MLC或TLC。</td>
<td style="background: Wheat;">开关</td>
<td style="background: LightCoral;">逆（增加，坏）</td>
</tr>
</tbody><tfoot></tfoot></table>

<table>
<caption>关系定义</caption>
<tbody><tr>
<th>类型</th>
<th>关系</th>
<th>描述</th>
</tr>
<tr>
<td style="background: Lightblue;" rowspan="2">变量</td>
<td style="background: LightCoral;">正</td>
<td style="background: LightCoral;">随着因子增加WA增加</td>
</tr>
<tr>
<td style="background: Lightgreen;">反</td>
<td style="background: Lightgreen;">随着因子增加WA减小</td>
</tr>
<tr>
<td style="background: wheat;" rowspan="2">开关</td>
<td style="background: Lightgreen;">顺</td>
<td style="background: Lightgreen;">当因子开启时WA减小</td>
</tr>
<tr>
<td style="background: LightCoral;">逆</td>
<td style="background: LightCoral;">当因子开启时WA减小</td>
</tr>
</tbody></table>

#### 垃圾回收

当一个块中的部分页被删除或替换后，这些页便会被标记为无效页。如果想继续想这些无效的页写入数据，变需要擦除整个区块。然而区块中可能含有存储的有效数据。如果不擦除这样的区块，则包含无效页的区块会越来越多，最终会无空间可用。因此必须回收这样的空间，这个过程被称为垃圾回收。

如图所示。页面能一直写入，直至填满区块。然后，当前的数据页被移动至新的区块，旧的区块被擦除。（图示：1.四个页面（A-D）写入一个区块（X）。单独的空闲（已擦除）页面可以直接写入；2.四个新页（E-H）和四个替代页（A'-D'）写入区块（X）。原来的A-D页现在包含的是无效（过期）数据，但直至整个区块被擦除前，页面都不能重新写入；3.要向含有过期数据的页面（A-D）写入数据，有效页面（E-H和A'-D'）被读取并写入区块（Y），然后区块（X）被擦除。最后一步称为“垃圾回收”。）

##### 后台垃圾回收

垃圾回收的过程包括读取并重新向闪存写入数据。这意味着，主控写入新数据时，如果大量区块含有无效页面，就必须先执行垃圾回收，之后才写入新数据。这显著降低了系统的性能。有的SSD控制器实现了“后台垃圾回收”（BGC），有时也被称为“空闲垃圾回收”或“空闲时间垃圾回收”（ITGC），能让控制器在主控需要写入新的数据之前，使用空闲时间整理闪存块。这使驱动器能维持较高的性能。

#### 预留空间

预留空间（有时简称OP）是闪存的物理容量和操作系统（OS）呈现给用户的可用逻辑容量之间的差值。在SSD的垃圾收集、耗损均衡及坏块映射操作中，额外的预留空间有助于降低控制器写入闪存时的写入放大。厂商通常会预留20%以上的空间。建议用户在使用闪存时人为的预留空间，

#### TRIM

TRIM是一个SATA命令，使操作系统告诉SSD不再需要哪些之前保存过数据的区块。可能这些文件已被删除，或整个分区已被格式化。如果一个文件被更改，闪存会写入这份文件新的版本，并将老版本标记为废弃的页以便垃圾回收。但如果用户或操作系统删除一个文件，通常只会将该文件标记为已删除，而并未真正擦除磁盘上的实际内容。正因如此，SSD不知道可以擦除这些已经删除的文件先前占用的页，在垃圾回收时仍会保留它们。发送TRIM后，闪存便不需要再维护这些数据。

#### 耗损均衡

耗损平均技术（英语：Wear Leveling）是闪存存储器（NAND flash）上的一种抹平技术。闪存存储器的区块有抺写次数的限制，针对同一个单一区块，进行重复抺除、写入，将会造成读取速度变慢，甚至损坏而无法使用。耗损平均技术目的在于平均使用闪存中的每个储存区块，以避免某些“特定”储存区块因过度使用而形成坏区块。磨损均衡算法通过将写入分配到闪存介质上的多个扇区，控制闪存介质扇区的不均匀“磨损”。原则上，磨损均衡算法能使闪存介质上的所有扇区几乎同时达到其耐久限制，从而延长闪存介质的使用寿命。通过使用老化机制，可警告用户何时达到耐久限制，从而提前进行内容备份，防止数据丢失。耗损平均技术的性能及寿命依赖算法及控制器的优劣，性能常会在经常多次写入及剩余容量很少时下降，有时可以借由牺牲寿命来增加性能、或以掉速为代价来确保可靠度。

#### 静动数据分离

对SSD控制器来说，静动数据分离并不是一件简单的事。该方法需要SSD控制器将数据不断变化、需要重写（动态数据）的与数据很少改变、且不需要任何重写（静态数据）的LBA分离开来。如果数据混于同一区块，正如目前几乎所有系统所做的那样，SSD控制器在重写时，就需要垃圾回收动态数据（引起重写的原因）和静态数据（不需要任何重写）。任何对操作中未涉及数据的垃圾回收都会增加写入放大。因此分离数据将使静态数据留在原地，如果它永远不会改写，写入放大就能达到最低。

然而，静动数据分离虽能减小写入放大，却无益于耗损均衡。静态数据的块会有很长的寿命。因此，一些主控会偶尔移动静态数据。耗损均衡与静动数据分离这两个技术为矛盾关系，只能找到一个中间位置。

#### 动态磨损均衡

动态磨损均衡是一种算法，控制器用备用区块列表中的块替换旧的块。当主机准备改写某个块时，备用区块列表中的第一个块将被用于替换该块，该块将被擦除并放入备用区块列表。

## 光盘

第一代：CD、VCD；第二代：DVD；第三代：BD。文件系统：CDFS、UDF。

## 软盘

软盘（Floppy Disk，简称“FD”）在台湾常称作磁片，是个人电脑设备中，取代磁带的可移动存储媒体。第一个软盘是由IBM于1971年开发出的，直径8吋。随着硬件技术的发展与使用的需要，又派生出5.25吋的软盘，并广泛使用在Apple II、IBM PC及其他兼容电脑上。苹果1984年在Mac机开始采用3.5吋软盘，此时容量还不到1MB，后来，日本索尼的3.5吋软盘容量达到1.44MB，这种软盘80至90年代盛行，直至2000年代以前，3.5吋软盘驱动器仍是电脑普及设备之一，后已渐被淘汰。虽然软盘不再被使用，许多软件的存储按钮仍使用软盘作为图标。

## U盘

U盘，发明者尚有争议，出现于上世纪末期。它是一种使用USB接口连接计算机，并通常通过闪存来进行数据存储的小型便携存储设备。一般U盘体积极小、重量轻、可重复写入，面世后迅速普及并取代传统的软盘及软盘驱动器。有时读卡器也会被归类为U盘，但这类设备的记忆芯片并不是内置的，而是可以抽换的存储卡。

相较于其他便携式存储设备（尤其是软盘），U盘有许多优点：较不占空间、能存储较多数据、读写速度较快、不会因刮伤或发霉而无法使用。这类的USB存储设备使用USB大量存储设备标准，在近代的操作系统如Windows、OS X、Linux与Unix中皆有内置支持。